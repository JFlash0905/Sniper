<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Sniper J GM æ¨¡æ“¬å™¨ v1.1</title>
  <style>
    body {
      font-family: "Microsoft JhengHei", sans-serif;
      margin: 0;
      padding: 20px;
      background: linear-gradient(to right, #f0f9ff, #e0ecff);
      box-sizing: border-box;
    }
    h1 {
      color: #2c3e50;
      text-align: center;
    }
    .button-area {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }
    button {
      padding: 10px 16px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      background-color: #3498db;
      color: white;
      transition: background-color 0.2s;
    }
    button:hover {
      background-color: #2980b9;
    }
    button:disabled {
      background-color: #aaa;
      cursor: not-allowed;
    }
    .section {
      margin: 20px auto;
      max-width: 900px;
    }
    .player {
      background: #ffffffcc;
      border-radius: 8px;
      padding: 10px;
      margin: 10px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .player-info {
      flex-grow: 1;
    }
    .stars {
      color: gold;
      font-size: 14px;
      margin-left: 6px;
    }
    #summaryBar {
      text-align: center;
      margin-bottom: 15px;
      font-weight: bold;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <div class="section">
    <h1>ğŸ€ Sniper J GM æ¨¡æ“¬å™¨ v1.1</h1>
    <div id="summaryBar">è¼‰å…¥ä¸­...</div>
    <div class="button-area">
      <button id="btnShowWarriors">å‹‡å£«é™£å®¹</button>
      <button id="btnFreeAgents">è‡ªç”±å¸‚å ´</button>
      <button id="btnOtherTeams">å…¶ä»–éšŠä¼</button>
      <button id="btnResetTraining">é‡ç½®è¨“ç·´</button>
      <button id="btnTradeLog">å‹æ•—ç´€éŒ„</button>
      <button id="btnClear">æ¸…é™¤å­˜æª”</button>
    </div>
    <div id="contentArea"></div>
  </div>

<script>
(() => {
const ratingMap = { C:1, "C+":2, "B-":3, B:4, "B+":5, "A-":6, A:7, "A+":8, S:9, "S+":10 };
const ratingStars = r => "â˜…".repeat(Math.min(5, Math.round((ratingMap[r]||1)/2)));

let warriors, freeAgents, otherTeams, money, salaryCap, picks;

function defaultData() {
  return {
    warriors: [
      { name:"Stephen Curry", rating:"S", salary:35, trained:false },
      { name:"Klay Thompson", rating:"B+", salary:20, trained:false },
      { name:"Andrew Wiggins", rating:"B+", salary:22, trained:false },
      { name:"Jonathan Kuminga", rating:"B", salary:15, trained:false },
      { name:"Draymond Green", rating:"B", salary:18, trained:false }
    ],
    freeAgents: [
      { name:"Malik Beasley", rating:"B", salary:15 },
      { name:"Robert Covington", rating:"B-", salary:12 },
      { name:"Dennis Smith Jr.", rating:"B-", salary:9 }
    ],
    otherTeams: {
      ç°ç‹¼: [
        { name:"Anthony Edwards", rating:"S", salary:32 },
        { name:"Karl-Anthony Towns", rating:"A", salary:28 }
      ],
      é‡‘å¡Š: [
        { name:"Nikola Jokic", rating:"S+", salary:38 },
        { name:"Jamal Murray", rating:"A", salary:27 }
      ]
    },
    money: 100,
    salaryCap: 120,
    picks: 1
  };
}

function save() {
  localStorage.setItem("sniperJGM", JSON.stringify({warriors, freeAgents, otherTeams, money, salaryCap, picks}));
}
function load() {
  const data = JSON.parse(localStorage.getItem("sniperJGM"));
  if (data) {
    ({warriors, freeAgents, otherTeams, money, salaryCap, picks} = data);
  } else {
    ({warriors, freeAgents, otherTeams, money, salaryCap, picks} = defaultData());
    save();
  }
}
function getTotalSalary() {
  return warriors.reduce((sum, p) => sum + (p.salary || 0), 0);
}
function renderAssets() {
  document.getElementById("summaryBar").innerHTML =
    `ğŸ’° è³‡é‡‘ï¼š$${money}Mï½œğŸ’¼ å·¥è³‡ï¼š$${getTotalSalary()}M / $${salaryCap}Mï½œğŸ¯ é¦–è¼ªç±¤ï¼š${picks}`;
}
function renderWarriors() {
  const html = warriors.map((p, i) => `
    <div class="player">
      <div class="player-info"><strong>${p.name}</strong>ï½œ${p.rating}ï½œ${ratingStars(p.rating)}ï½œ$${p.salary}M ${p.trained ? 'ğŸ§  å·²è¨“ç·´' : ''}</div>
      <button ${p.trained ? "disabled" : ""} onclick="trainPlayer(${i})">è¨“ç·´</button>
    </div>`).join("");
  document.getElementById("contentArea").innerHTML = `<h2>ğŸ€ å‹‡å£«é™£å®¹</h2>${html}`;
}
window.trainPlayer = function(index) {
  warriors[index].trained = true;
  alert(`${warriors[index].name} å·²è¨“ç·´ï¼`);
  save(); renderWarriors(); renderAssets();
}
function renderFreeAgents() {
  const html = freeAgents.map((p, i) => `
    <div class="player">
      <div class="player-info"><strong>${p.name}</strong>ï½œ${p.rating}ï½œ${ratingStars(p.rating)}ï½œ$${p.salary}M</div>
      <button onclick="signFreeAgent(${i})">ç°½ä¸‹</button>
    </div>`).join("");
  document.getElementById("contentArea").innerHTML = `<h2>ğŸ“ è‡ªç”±å¸‚å ´</h2>${html}`;
}
window.signFreeAgent = function(index) {
  const p = freeAgents[index];
  if (money >= p.salary) {
    warriors.push({...p, trained:false});
    money -= p.salary;
    freeAgents.splice(index, 1);
    alert(`${p.name} å·²åŠ å…¥å‹‡å£«ï¼`);
    save(); renderFreeAgents(); renderAssets();
  } else {
    alert("è³‡é‡‘ä¸è¶³ï¼");
  }
}
function renderTeamSelection() {
  const html = Object.keys(otherTeams).map(t => `<button onclick="renderOtherTeam('${t}')">${t}</button>`).join(" ");
  document.getElementById("contentArea").innerHTML = `<h2>ğŸŒ é¸æ“‡å…¶ä»–éšŠä¼</h2>${html}`;
}
window.renderOtherTeam = function(team) {
  const players = otherTeams[team];
  const html = players.map(p => `
    <div class="player">
      <div class="player-info"><strong>${p.name}</strong>ï½œ${p.rating}ï½œ${ratingStars(p.rating)}ï½œ$${p.salary}M</div>
      <button onclick="startTrade('${team}','${p.name}')">äº¤æ˜“</button>
    </div>`).join("");
  document.getElementById("contentArea").innerHTML = `<h2>ğŸ‘¥ ${team} çƒå“¡åˆ—è¡¨</h2>${html}`;
}
window.startTrade = function(team, targetName) {
  const offer = prompt(`ä½ è¦ç”¨å“ªäº›å‹‡å£«çƒå“¡æ› "${targetName}"ï¼Ÿç”¨é€—è™Ÿåˆ†éš”ï¼Œä¾‹å¦‚ï¼šWiggins,Kuminga`);
  if (!offer) return;
  const includePick = confirm("æ˜¯å¦åŒ…å«é¦–è¼ªç±¤ï¼Ÿ");

  const offerNames = offer.split(",").map(n => n.trim());
  const offerPlayers = warriors.filter(p => offerNames.includes(p.name));
  const totalOfferSalary = offerPlayers.reduce((sum, p) => sum + p.salary, 0) + (includePick ? 5 : 0);

  const target = otherTeams[team].find(p => p.name === targetName);
  if (!target) return alert("ç›®æ¨™çƒå“¡ä¸å­˜åœ¨");
  const salaryDiff = Math.abs(totalOfferSalary - target.salary);
  if (salaryDiff > 5) return alert("âš ï¸ è–ªè³‡å·®é¡è¶…é Â±5Mï¼Œäº¤æ˜“å¤±æ•—");

  warriors = warriors.filter(p => !offerNames.includes(p.name));
  warriors.push({...target, trained:false});
  otherTeams[team] = otherTeams[team].filter(p => p.name !== targetName);
  offerPlayers.forEach(p => otherTeams[team].push(p));
  if (includePick) picks--;

  alert(`âœ… ${target.name} åŠ å…¥å‹‡å£«ï¼`);
  save(); renderOtherTeam(team); renderAssets();
}

window.onload = function() {
  load();
  renderAssets();
  renderWarriors();
  document.getElementById("btnShowWarriors").onclick = renderWarriors;
  document.getElementById("btnFreeAgents").onclick = renderFreeAgents;
  document.getElementById("btnOtherTeams").onclick = renderTeamSelection;
  document.getElementById("btnResetTraining").onclick = () => {
    warriors.forEach(p => p.trained = false);
    alert("âœ… æ‰€æœ‰è¨“ç·´å·²é‡ç½®ï¼");
    save(); renderWarriors();
  };
  document.getElementById("btnClear").onclick = () => {
    if (confirm("æ˜¯å¦é‡ç½®æ‰€æœ‰è³‡æ–™ï¼Ÿ")) {
      localStorage.removeItem("sniperJGM");
      location.reload();
    }
  };
  document.getElementById("btnTradeLog").onclick = () => {
    alert("ï¼ˆå‹æ•—ç´€éŒ„æ¨¡çµ„å°šåœ¨é–‹ç™¼ä¸­ï¼‰");
  };
}
})();
</script>
</body>
</html>
